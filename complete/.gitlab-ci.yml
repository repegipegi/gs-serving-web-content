build-jar-complete:
  image: "openjdk:8-jdk"
  stage: build-jar
  only:
    changes:
      - "*"  # run pipeline if a root-level file like Makefile or docker-compose.yml is changed
      - "complete/**/*"
  before_script:
    - cd complete
    - chmod +x gradlew
  script:
    - ./gradlew bootJar

build-image-complete:
  image: docker:19.03.0
#  image: docker:latest
  stage: build-image
  services:
    - docker:19.03.0-dind
  before_script:
    - cd complete
  script:
    - docker build -t asia.gcr.io/pegipegi-user/cicd/complete .
  needs:
    - build-jar-complete
